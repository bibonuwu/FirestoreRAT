<Window x:Class="ClientFirestore.ChatWindow"
              xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Chat" Height="400" Width="500"
        WindowStyle="SingleBorderWindow"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Верх: кнопки управления -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" HorizontalAlignment="Right">
            <Button x:Name="btnMinimize" Content="_" Width="25" Margin="4,0"
                    Click="btnMinimize_Click"/>
            <Button x:Name="btnRestore" Content="▭" Width="25" Margin="4,0"
                    Click="btnRestore_Click"/>
            <Button x:Name="btnClose" Content="X" Width="25" Margin="4,0"
                    Click="btnClose_Click"/>
        </StackPanel>

        <!-- Список сообщений -->
        <ListBox x:Name="MsgList"
                 Grid.Row="1"
                 Margin="0,4,0,4">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border Margin="0,2"
                            Padding="4"
                            CornerRadius="4"
                            BorderBrush="Gray"
                            BorderThickness="0.5">
                        <StackPanel>
                            <TextBlock FontSize="10"
                                       Foreground="Gray"
                                       Text="{Binding Time}"/>
                            <TextBlock FontWeight="Bold"
                                       Text="{Binding Sender}"/>
                            <TextBlock TextWrapping="Wrap"
                                       Text="{Binding Body}"/>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!-- Ввод сообщения -->
        <DockPanel Grid.Row="2">
            <Button Content="Отправить"
                    Width="90"
                    DockPanel.Dock="Right"
                    Margin="4,0,0,0"
                    Click="Send_Click"/>
            <TextBox x:Name="Input"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     VerticalScrollBarVisibility="Auto"
                     PreviewKeyDown="Input_PreviewKeyDown"/>
        </DockPanel>
    </Grid>
</Window>